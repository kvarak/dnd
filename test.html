
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Skills</title>

    <!-- Compiled and minified Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Compiled Bootstrap JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

    <!-- Fonts -->
    <link href="https://use.fontawesome.com/releases/v5.15.1/css/all.css" rel="stylesheet" />
    <link href='https://fonts.googleapis.com/css?family=Buenard' rel='stylesheet'>

    <!-- My style -->
    <link rel="stylesheet" href="assets/css/originalDndStyle.css">
    <link rel="stylesheet" href="assets/css/style.css">

  </head>
  <body>

    <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark">

  <a href="/dnd" class="navbar-left">
    <img id="logo" src="/dnd/assets/images/transparent.png">
  </a>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav mr-auto">
      
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Campaigns
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          
          <a class="dropdown-item" href="/dnd/Campaigns/into-the-dark-continent.html">Into the Dark Continent</a>
          
        </div>
      </li>
      
      
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Classes
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          
          <a class="dropdown-item" href="/dnd/Classes/alchemist.html">Alchemist</a>
          
          <a class="dropdown-item" href="/dnd/Classes/barbarian.html">Barbarian</a>
          
          <a class="dropdown-item" href="/dnd/Classes/bard.html">Bard</a>
          
          <a class="dropdown-item" href="/dnd/Classes/cavalier.html">Cavalier</a>
          
          <a class="dropdown-item" href="/dnd/Classes/cleric.html">Cleric</a>
          
          <a class="dropdown-item" href="/dnd/Classes/cursed.html">Cursed</a>
          
        </div>
      </li>
      
      
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Folk
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          
          <a class="dropdown-item" href="/dnd/Folk/dwarf.html">Dwarf</a>
          
        </div>
      </li>
      
      
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Links
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          
          <a class="dropdown-item" href="/dnd/Links/statistik.html">Statistics</a>
          
        </div>
      </li>
      
      
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Rules
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          
          <a class="dropdown-item" href="/dnd/Rules/skills.html">Skills</a>
          
          <a class="dropdown-item" href="/dnd/Rules/tools.html">Tools Proficiences</a>
          
        </div>
      </li>
      
      
      
      
    </ul>
  </div>
</nav>

<!doctype html>
<html>
  <head>
    {% include head.html %}
    <!-- <link href="../assets/css/newstyle.css" rel="stylesheet"> -->

    <!-- Datatables CSS -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs/dt-1.12.0/datatables.min.css"/>
    <!-- Datatables JavaScript -->
    <script type="text/javascript" src="https://cdn.datatables.net/v/bs/dt-1.12.0/datatables.min.js"></script>
    <!-- Papa Parse -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.1.0/papaparse.min.js"></script>

    <script type="text/javascript">
      // timeline
      // var public_spreadsheet_url = 'https://docs.google.com/spreadsheets/d/1prVAoIfRSMnyqJ3dTe-0jRRja8c3Gy-Be8hiP3VYn28/pub?output=csv';
      // spells
      var public_spreadsheet_url = 'https://docs.google.com/spreadsheets/d/1Lsmu72Ssq48d7Df2zqYDFUoHsdsOb7K1L_u1FshKJWc/pub?output=csv';

      function init() {
        Papa.parse(public_spreadsheet_url, {
          download: true,
          header: true,
          complete: fillTable
        })
      }

      window.addEventListener('DOMContentLoaded', init)

      var contentTable = $('#contentTable').DataTable({data: []});

      function fillTable(results) {
        var tableContent = []
        var data = results.data

        document.getElementById("alert").innerHTML = "Imported " + data.length + " spells.";

        data.forEach((row) => {
          var txt = "";
          txt = txt + "<h4><a class=\"internal-link\" name=\"" + row['Name'].replace(/\s/g, '') + "\">" + row['Name'] + "</h4>";
          if (row['Level'] == "0") {
            txt = txt + "<i>Cantrip";
          } else {
            txt = txt + "<i>Level: " + row['Level'];
          }
          if (row['Ritual'] == "Yes") {
            txt = txt + " (ritual)";
          }
          txt = txt + "</i><br/>";
          txt = txt + "<b>Casting time: </b>" + row['Casting_Time'] + "<br/>";
          txt = txt + "<b>Target: </b>" + row['Target'] + "<br/>";
          txt = txt + "<b>Range: </b>" + row['Range'] + "<br/>";
          txt = txt + "<b>Components: </b>" + row['Components'] + "<br/>";
          txt = txt + "<b>Duration: </b>";
          if (row['Conc'] == "Yes") {
            txt = txt + "Concentration, up to " + row['Duration'];
          } else {
            txt = txt + row['Duration'];
          }

          var archetypes = ""
          {% for class in page.classes %}
          if (row['{{ class }}'] != "Yes" && row['{{ class }}'] != "No")
            archetypes += row['{{ class }}'] + ", "
          {% endfor %}

          tableContent.push([
            txt,
            row['Web_Description'],
            row['Level'],
            archetypes,
            {% for class in page.classes %}
            row['{{ class }}'],
            {% endfor %}
            row['Ritual']]);
        });

        contentTable = $('#contentTable').DataTable({
          data: tableContent,
          order: [[0, 'desc']],
          ordering: false,
          // lengthMenu: [[ 25, 50, 100, -1], [25, 50, 100, "All"]],
          iDisplayLength: -1,
          columnDefs: [
            { targets: [0,1], visible: true},
            { targets: '_all', visible: false }],
          // aoColumnDefs: [{ sClass: "td-nobreak",
          //                   aTargets: [ 0 ] },
          //                 { sClass: "td-center",
          //                   aTargets: [ 1 ] }],
          columns: [
            { title: 'Spell'},
            { title: 'Description'},
            { title: 'Level'},
            { title: 'Archetypes'},
            {% for class in page.classes %}
            { title: '{{ class }}'},
            {% endfor %}
            { title: 'Ritual'}],
          dom: "<'row'<'col-sm-12'f>>" + "<'row'<'col-sm-12'tr>>"
        });

        {% assign levelposition = 2 %}
        {% assign firstclass = 4 %}
        {% assign i = firstclass %}
        {% for class in page.classes %}

        $('#show{{ class }}').on('change', function() {
          if ($(this).is(':checked')) {
            $.fn.dataTable.ext.search.push(
              function(settings, data, dataIndex) {
                return data[{{ i }}] != 'No'
              }
            )
          } else {
            $.fn.dataTable.ext.search.pop()
          }
          contentTable.draw()
        });

        {% assign i = i | plus:1 %}
        {% endfor %}

        $('#levelSelection').on('change',function(){
          var selectedValue = $(this).val();
          $.fn.dataTable.ext.search.pop()
          if (selectedValue != "reset") {
            $.fn.dataTable.ext.search.push(
              function(settings, data, dataIndex) {
                return data[{{ levelposition }}] == selectedValue
              }
            )
          }
          contentTable.draw()
        });

      }

    </script>
  </head>

  <body>

    {% include navigation.html %}
    <div class="container container-main">

      <!-- <h3>Spells</h3> -->

        {{ content }}

        <label for="levelSelection">Spell level:</label>
        <select name="levelSelection" id="levelSelection">
          <option value="reset">All</option>
          <option value="0">Cantrip</option>
          {% for n in (1..9) %}
          <option value="{{n}}">Lvl {{n}}</option>
          {% endfor %}
        </select>

        <p>
          {% for class in page.classes %}
          <label><input type="checkbox" id="show{{ class }}"> {{ class }}</label>
          {% endfor %}
        </p>

        <p id="alert" style="font-style:italic;font-size-adjust:-1;">Please wait, importing spells...</p>

      <table class="table table-striped table-hover" id="contentTable"></table>

    </div>

</body>
</html>
