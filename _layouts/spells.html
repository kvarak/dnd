<!doctype html>
<html>
  <head>
    {% include head.html %}
    <link href="../assets/css/newstyle.css" rel="stylesheet">

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.1.0/papaparse.min.js"></script>
    <script type="text/javascript">
      // timeline
      // var public_spreadsheet_url = 'https://docs.google.com/spreadsheets/d/1prVAoIfRSMnyqJ3dTe-0jRRja8c3Gy-Be8hiP3VYn28/pub?output=csv';
      // spells
      var public_spreadsheet_url = 'https://docs.google.com/spreadsheets/d/1Lsmu72Ssq48d7Df2zqYDFUoHsdsOb7K1L_u1FshKJWc/pub?output=csv';

      function init() {
        Papa.parse(public_spreadsheet_url, {
          download: true,
          header: true,
          complete: showInfo
        })
      }

      window.addEventListener('DOMContentLoaded', init)

      function showInfo(results) {
        var data = results.data
        var txt = "";

        document.getElementById("alert").innerHTML = "Imported " + data.length + " spells.";
        // data comes through as a simple array since simpleSheet is turned on
        // alert("Successfully processed " + data.length + " rows!")
        for (d in data) {
          // console.log(d);
          txt = txt + "<tr>";
          txt = txt + "<td>" + data[d].Name + "</td>";
          txt = txt + "<td>" + data[d].Level + "</td>";
          txt = txt + "<td>" + data[d].School + "</td>";
          txt = txt + "<td>" + data[d].Web_Description + "</td>";
          txt = txt + "</tr>";
        }

        document.getElementById("sheetcontent").innerHTML = txt;
        // console.log(data);
      }

      // document.write("The published spreadsheet is located at <a target='_new' href='" + public_spreadsheet_url + "'>" + public_spreadsheet_url + "</a>");
    </script>
  </head>

  <body>

    {% include navigation.html %}
    <div class="container container-main">

      <section class="container">
        <h1>Spells</h1>
        <input type="search" class="light-table-filter" data-table="table-info" placeholder="Filter/Search">

        <p id="alert"></p>

        <table class="table-info table">
          <thead>
            <tr>
              <th>Name</th>
              <th>Level</th>
              <th>School</th>
              <th>Web_Description</th>
            </tr>
          </thead>
          <tbody id="sheetcontent">
          </tbody>
        </table>
      </section>

      <script src="../assets/js/function.js"></script>

      {{ content }}

    </div>

  </body>
</html>
